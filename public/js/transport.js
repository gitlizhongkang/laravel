var Transport={filename:"transport.js",debugging:{isDebugging:0,debuggingMode:0,linefeed:"",containerId:0},debug:function(A,B){this.debugging={"isDebugging":A,"debuggingMode":B,"linefeed":B?"<br />":"\n","containerId":"dubugging-container"+new Date().getTime()}},onComplete:function(){},onRunning:function(){},run:function(H,F,B,K,E,A,J){F=this.parseParams(F);K=typeof(K)==="string"&&K.toUpperCase()==="GET"?"GET":"POST";if(K==="GET"){var L=new Date();H+=F?(H.indexOf("?")===-1?"?":"&")+F:"";H=encodeURI(H)+(H.indexOf("?")===-1?"?":"&")+L.getTime()+L.getMilliseconds();F=null}E=typeof(E)==="string"&&((E=E.toUpperCase())==="JSON"||E==="XML")?E:"TEXT";A=A===false?false:true;var C=this.createXMLHttpRequest();try{var I=this;if(typeof(I.onRunning)==="function"&&!J){I.onRunning()}C.open(K,H,A);if(K==="POST"){C.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(A){C.onreadystatechange=function(){if(C.readyState==4){switch(C.status){case 0:case 200:if(typeof(I.onComplete)==="function"){I.onComplete()}if(typeof(B)==="function"){B.call(I,I.parseResult(E,C),C.responseText)}break;case 304:break;case 400:alert("XmlHttpRequest status: [400] Bad Request");break;case 404:alert("XmlHttpRequest status: [404] \nThe requested URL "+H+" was not found on this server.");break;case 409:break;case 503:alert("XmlHttpRequest status: [503] Service Unavailable");break;default:alert("XmlHttpRequest status: ["+C.status+"] Unknow status.")}C=null}};if(C!=null){C.send(F)}}else{if(typeof(I.onRunning)==="function"){I.onRunning()}C.send(F);var D=I.parseResult(E,C);if(typeof(I.onComplete)==="function"){I.onComplete()}if(typeof(B)==="function"){B.call(I,D,C.responseText)}return D}}catch(G){if(typeof(I.onComplete)==="function"){I.onComplete()}alert(this.filename+"/run() error:"+G.description)}},displayDebuggingInfo:function(D,A){if(!this.debugging.debuggingMode){alert(D)}else{var E=this.debugging.containerId;if(!document.getElementById(E)){div=document.createElement("DIV");div.id=E;div.style.position="absolute";div.style.width="98%";div.style.border="1px solid #f00";div.style.backgroundColor="#eef";var C=document.body.scrollTop||window.pageYOffset||0;div.style.top=document.body.clientHeight*0.6+C+"px";document.body.appendChild(div);div.innerHTML="<div></div><hr style='height:1px;border:1px dashed red;'><div></div>"}var B=div.getElementsByTagName("DIV");if(A==="param"){B[0].innerHTML=D}else{B[1].innerHTML=D}}},createXMLHttpRequest:function(){var D=null;if(window.ActiveXObject){var B=["Microsoft.XMLHTTP","MSXML6.XMLHTTP","MSXML5.XMLHTTP","MSXML4.XMLHTTP","MSXML3.XMLHTTP","MSXML2.XMLHTTP","MSXML.XMLHTTP"];for(var A=0;A<B.length;A++){try{D=new ActiveXObject(B[A]);break}catch(C){continue}}}else{D=new XMLHttpRequest()}return D},onXMLHttpRequestError:function(B,A){throw"URL: "+A+"\nreadyState: "+B.readyState+"\nstate: "+B.status+"\nheaders: "+B.getAllResponseHeaders()},parseParams:function(E){var B="";E=E?E:"";if(typeof(E)==="string"){B=E}else{if(typeof(E)==="object"){try{B="JSON="+E.toJSONString()}catch(A){alert("Can't stringify JSON!");return false}}else{alert("Invalid parameters!");return false}}if(this.debugging.isDebugging){var C=this.debugging.linefeed,D="[Original Parameters]"+C+E+C+C+"[Parsed Parameters]"+C+B;this.displayDebuggingInfo(D,"param")}return B},preFilter:function(A){return A.replace(/\xEF\xBB\xBF/g,"")},parseResult:function(B,D){var A=null;switch(B){case"JSON":A=this.preFilter(D.responseText);try{A=A.parseJSON()}catch(C){throw this.filename+"/parseResult() error: can't parse to JSON.\n\n"+D.responseText}break;case"XML":A=D.responseXML;break;case"TEXT":A=this.preFilter(D.responseText);break;default:throw this.filename+"/parseResult() error: unknown response type:"+B}if(this.debugging.isDebugging){var E=this.debugging.linefeed,F="[Response Result of "+B+" Format]"+E+A;if(B==="JSON"){F="[Response Result of TEXT Format]"+E+D.responseText+E+E+F}this.displayDebuggingInfo(F,"result")}return A}};var Ajax=Transport;Ajax.call=Transport.run;if(!Object.prototype.toJSONString){Array.prototype.toJSONString=function(){var F=["["],E,A,C=this.length,D;function B(G){if(E){F.push(",")}F.push(G);E=true}for(A=0;A<C;A++){D=this[A];switch(typeof D){case"undefined":case"function":case"unknown":break;case"object":if(D){if(typeof D.toJSONString==="function"){B(D.toJSONString())}}else{B("null")}break;default:B(D.toJSONString())}}F.push("]");return F.join("")};Boolean.prototype.toJSONString=function(){return String(this)};Date.prototype.toJSONString=function(){function A(B){return B<10?"0"+B:B}return'"'+this.getFullYear()+"-"+A(this.getMonth()+1)+"-"+A(this.getDate())+"T"+A(this.getHours())+":"+A(this.getMinutes())+":"+A(this.getSeconds())+'"'};Number.prototype.toJSONString=function(){return isFinite(this)?String(this):"null"};Object.prototype.toJSONString=function(){var D=["{"],C,E,B;function A(F){if(C){D.push(",")}D.push(E.toJSONString(),":",F);C=true}for(E in this){if(this.hasOwnProperty(E)){B=this[E];switch(typeof B){case"undefined":case"function":case"unknown":break;case"object":if(this!==window){if(B){if(typeof B.toJSONString==="function"){A(B.toJSONString())}}else{A("null")}}break;default:A(B.toJSONString())}}}D.push("}");return D.join("")};(function(s){var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};s.parseJSON=function(filter){try{if(/^("(\\.|[^"\\\n\r])*?"|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/.test(this)){var j=eval("("+this+")");if(typeof filter==="function"){function walk(k,v){if(v&&typeof v==="object"){for(var i in v){if(v.hasOwnProperty(i)){v[i]=walk(i,v[i])}}}return filter(k,v)}j=walk("",j)}return j}}catch(e){}throw new SyntaxError("parseJSON")};s.toJSONString=function(){var _self=this.replace("&","%26");if(/["\\\x00-\x1f]/.test(this)){return'"'+_self.replace(/([\x00-\x1f\\"])/g,function(a,b){var c=m[b];if(c){return c}c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+_self+'"'}})(String.prototype)}Ajax.onRunning=showLoader;Ajax.onComplete=hideLoader;function showLoader(){document.getElementsByTagName("body").item(0).style.cursor="wait";if(top.frames["header-frame"]&&top.frames["header-frame"].document.getElementById("load-div")){top.frames["header-frame"].document.getElementById("load-div").style.display="block"}else{var A=document.getElementById("loader");if(!A&&typeof(process_request)!="undefined"){A=document.createElement("DIV");A.id="loader";A.innerHTML=process_request;document.body.appendChild(A)}}}function hideLoader(){document.getElementsByTagName("body").item(0).style.cursor="auto";if(top.frames["header-frame"]&&top.frames["header-frame"].document.getElementById("load-div")){setTimeout(function(){top.frames["header-frame"].document.getElementById("load-div").style.display="none"},10)}else{try{var A=document.getElementById("loader");A.style.display="none";document.body.removeChild(A)}catch(B){}}};